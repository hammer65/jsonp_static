<link rel="import" href="../bower_components/polymer/polymer.html" />
<link rel="import" href="../bower_components/polymer-localforage/polymer-localforage.html" />

<dom-module id="app-storage">
  <template>
    <style>
      :host{
        display:none;
      };
    </style>
    <polymer-localforage name="{{id}}" id="store" />
  </template>
</dom-module>
<script>
  (function(){
    var _storage;

    Polymer({
      is: 'app-storage',
      properties:{
        id: String
      },
      ready: function(){
        _storage = this.$.store;
      },
      set: function(newVal){
        console.log("** new val **",newVal);
        console.log("** storage **",_storage);
        if(!_storage.value){
          _storage.value = [];
        }
        _storage.value[newVal.id] = newVal;
        var eName = this.id + "-change"
        this.fire(eName,_storage.value);
      },
      get: function(id){
        return _storage.value[id];
      },
      getAll: function(){
        ret = [];
        if(_storage.value){
          ret = _storage.value;
        }
        return ret;
      },
      deleteItem:function(id){
        delete _storage.value[id];
        var eName = this.id = '-change';
        this.fire(eName,_storage.value)
      }
    });
  })();
    
</script>